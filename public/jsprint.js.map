{"version":3,"sources":["app/app.coffee","app/config.coffee","app/utils.coffee"],"names":[],"mappings":"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","file":"public/jsprint.js","sourcesContent":["M = {\n  config: require 'jsprint/config'\n  utils:  require 'jsprint/utils'\n}\n\nclass Jsprint\n  # Configuration for Jsprint\n  CONFIG = new M.config.Main()\n\n  constructor: () ->\n    console.info? \"Jsprint version:\", CONFIG.getVersion()\n    @init()\n\n  init: ->\n    @renderImgLegends()\n    @renderHeader()\n    @renderFooter()\n    @renderLinkReferences()\n    @createSummary()\n\n  createSummary: ->\n    # Generating tags\n\n    # TODO: test new method\n    # tags = []\n    # tagsCounter = {}\n    # for i in [1..10]\n    #   tags.push \"H#{i}\"\n    #   tagsCounter[\"H#{i}\"] ||= 0\n    #   tagsCounter[\"H#{i}\"]++\n    #\n    # console.log tags, tagsCounter\n    # console.log tags.join(\" \")\n    # $(\".\" + CONFIG.getClass(\"page\")).each((i, page) ->\n    #   console.log i, page\n    #   $(tags.join(\" \")).each(  ->\n    #     console.log i\n    #   )\n    # )\n\n    # ----------------- Old\n    nbrtitle = undefined\n    pagenbr = undefined\n    JSP_TITLE_NBR = 0\n    JSP_TITLE2_NBR = 0\n    JSP_TITLE3_NBR = 0\n    JSP_TITLE4_NBR = 0\n    pagenbr = 0\n    nbrtitle = 0\n    header = @_getHeader()\n    $(\".\" + CONFIG.getClass(\"page\")).each (i, page) ->\n      pagenbr++\n      $(page).find(\".\" + CONFIG.getClass(\"title\")).each (_, title) ->\n        h_nbr = undefined\n        t = undefined\n        tag = undefined\n        t = $(title).text()\n        tag = $(this)[0].tagName\n        h_nbr = \"\"\n        nbrtitle++\n        if tag is \"H1\"\n          JSP_TITLE_NBR++\n          JSP_TITLE2_NBR = 0\n          h_nbr = JSP_TITLE_NBR\n        if tag is \"H2\"\n          JSP_TITLE2_NBR++\n          JSP_TITLE3_NBR = 0\n          h_nbr = JSP_TITLE_NBR + \".\" + JSP_TITLE2_NBR\n        if tag is \"H3\"\n          JSP_TITLE3_NBR++\n          JSP_TITLE4_NBR = 0\n          h_nbr = JSP_TITLE_NBR + \".\" + JSP_TITLE2_NBR + \".\" + JSP_TITLE3_NBR\n        if tag is \"H4\"\n          JSP_TITLE4_NBR++\n          h_nbr = JSP_TITLE_NBR + \".\" + JSP_TITLE2_NBR + \".\" +\n            JSP_TITLE3_NBR + \".\" + JSP_TITLE4_NBR\n        $(title).text h_nbr + \" \" + t\n        if nbrtitle % CONFIG.get(\"summary\", \"nbrtitle\") is 0\n          $(\".\" + CONFIG.getClass(\"page-summary\"))\n            .last().after \"</div><div class='\" +\n              CONFIG.getClass(\"page-summary\") + \" \" +\n              CONFIG.getClass(\"page\") + \"'><div class='\" +\n              CONFIG.getClass(\"summary\") + \"'></div>\"\n          $(\".\" + CONFIG.getClass(\"page-summary\")).last().prepend header\n        $(\".\" + CONFIG.getClass(\"summary\"))\n          .last().append \"<div class='\" + CONFIG.getClass(\"summary\") +\n          \"-\" + tag + \" \" + CONFIG.getClass(\"summary-entry\") +\n          \"'>\" + h_nbr + \" \" + t + \"<div>\" + pagenbr + \"</div></div>\"\n\n  renderLinkReferences: ->\n    $(\"a\").each (i) ->\n      i++\n      link = $(this).attr(\"href\")\n      text = $(this).text()\n      ref  = $(this).attr(\"ref\")\n      show = text\n      show = \"#{ref} (#{text})\"  if ref isnt undefined\n      $(this).append(\n        $(\"<sup/>\").text(\" [#{i}]\")\n      )\n      line = $(\"<div/>\").append(\n        $(\"<span/>\").attr(\"class\", \"index\").text(\"[#{i}]\")\n        $(\"<span/>\").attr(\"class\", \"text\").text(\" #{show}: \")\n        $(\"<span/>\").attr(\"class\", \"link\").append(\n          $(\"<a/>\").attr(\"href\", link).text(link)\n        )\n      )\n      $(\".#{CONFIG.getClass(\"bibliography\")}\").append(line)\n\n  renderImgLegends: ->\n    i = 0\n    $(\"img\").each ->\n      title = $(this).attr(\"title\")\n      ref   = $(this).attr(\"ref\")\n      if title? || ref?\n        i++\n        legendDOM  = $(\"<div/>\")\n          .attr('class', CONFIG.getClass(\"img-legend\"))\n          .html(\"#{title}  <sup>#{i}</sup>\")\n        $(this).after(legendDOM)\n\n        legendLineDOM = $(\"<div/>\")\n          .html(\"[#{i}] #{title} <i>(#{ref})</i>\")\n        M.utils.appendToClass(CONFIG.getClass(\"imageography\"), legendLineDOM)\n\n  _getHeader: ->\n    defHeader = $(\".#{CONFIG.getClass('def-header')}\").html() or \"\"\n    headerContent = $(\"<div/>\")\n      .attr(\"class\", CONFIG.getClass(\"header\"))\n      .html(defHeader)\n\n  _getFooter: (i) ->\n    outof = $(\"<div/>\")\n      .attr(\"class\", CONFIG.getClass(\"footer-pagenbr\"))\n      .text(\"#{i+1}/#{$(\".#{CONFIG.getClass(\"page\")}\").length}\")\n    $(\"<div/>\")\n      .attr(\"class\", CONFIG.getClass(\"footer\"))\n      .append(outof)\n\n  renderHeader: ->\n    $(\".#{CONFIG.getClass(\"page\")}\").each (i, page) =>\n      $(page).prepend @_getHeader()\n\n  renderFooter: ->\n    $(\".#{CONFIG.getClass(\"page\")}\").each (i, page) =>\n      $(page).append  @_getFooter(i)\n\n  toString: ->\n    return \"Version: JSPrint #{CONFIG.getVersion()}\\n\n      CLASSES: #{CONFIG.getClasses()}\"\n\njsprint = new Jsprint()\nconsole.log jsprint.toString()\n","module.exports = exp = {}\n\nexp.Main = class Main\n  VERSION = \"1.2\"\n\n  CLASS =\n    \"title\":          \"jsprint-title\"\n    \"page\":           \"jsprint-page\"\n    \"header\":         \"jsprint-page-header\"\n    \"footer\":         \"jsprint-page-footer\"\n    \"summary\":        \"jsprint-summary\"\n    \"bibliography\":   \"jsprint-bibliography\"\n    \"imageography\":   \"jsprint-imageography\"\n    \"footer-pagenbr\": \"jsprint-pagenbr\"\n    \"def-header\":     \"jsprint-def-header\"\n    \"page-summary\":   \"jsprint-page-summary\"\n    \"summary-entry\":  \"jsprint-summary-entry\"\n    \"img-legend\":     \"jsprint-img-legend\"\n\n  CONFIG =\n    summary:\n      nbrtitle: 45\n\n  constructor: -> null\n\n  getClass: (className) -> CLASS[className]\n\n  getClasses: -> [k] for k, v of CLASS\n\n  getVersion: -> VERSION\n\n  get: (configName, option) -> CONFIG[configName][option]\n","module.exports = exp = {}\n\nexp.appendToClass = appendToClass = (className, content) ->\n  $(\".#{className}\").append(content)\n"]}